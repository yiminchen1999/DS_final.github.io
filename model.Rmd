---
title: "Frequency"
output:
  html_document:
    theme: cosmo
    toc : true
    toc_float: true
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(leaflet)
library(tidyverse)
library(readr)
library(dplyr)
library(ggplot2)
library(shiny)
library(scales)
library(patchwork)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	message = FALSE, 
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))
```


```{r, include=FALSE}
census =
  read_csv("2018_Central_Park_Squirrel_Census_-_Squirrel_Data.csv")%>% 
  janitor::clean_names() %>%
  #filter(!is.na(primary_fur_color))%>%
  mutate(date=as.character(date),
         long = as.numeric(x),
         lat = as.numeric(y),
         shift = as.character(shift),
         activity = case_when( running == "TRUE" ~ "running",
                               chasing == "TRUE" ~ "chasing",
                               climbing == "TRUE" ~ "climbing",
                               eating == "TRUE" ~ "eating",
                               foraging == "TRUE" ~ "foraging"),
         reaction = case_when( approaches == "TRUE" ~ "approaches",
                               indifferent == "TRUE" ~ "indifferent",
                               runs_from == "TRUE" ~ "runs_from"),
         sounds = case_when( kuks == "TRUE" ~ "kuks",
                               quaas == "TRUE" ~ "quaas",
                               moans == "TRUE" ~ "moans"))%>%
  select(-x,-y,-running,-chasing,-climbing,-eating,-foraging,-above_ground_sighter_measurement,-color_notes,-other_activities,-specific_location ,-tail_flags ,-tail_twitches,-other_interactions,-kuks,-quaas,-moans,-approaches,-indifferent,-runs_from)
```

### Central Park Squirrels Distribution by Days (AM/PM)

In this part, we were interested in looking at the central park squirrel census collected in October 2018. We make this graph to analysis the frequency of squirrels recorded for each of the observation (AM or PM).

```{r}
dates = 
  census %>%
  mutate(Month = substr(date, 1,2), Day = substr(date, 3,4), Year = substr(date,5,9))

dates %>% 
  group_by(Day, shift) %>%
  count() %>%
  ggplot() +
  geom_col(aes(x = Day, y = n, fill = shift)) +
  scale_fill_brewer(palette = "Paired") +
  labs(x = "Day", y = "Number of Observations", fill = 'Shift') +
  ggtitle('Central Park Squirrels Distribution by Days (AM/PM)') +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs(fill='Time of day') 
```

### Central Park Squirrels Distribution by Primary Fur Colors

In this part, we  make this graph to analysis the frequency of squirrels recorded for each of the observation by primary fur color. 

```{r}
dates %>%
  group_by(Day, primary_fur_color) %>% 
  count() %>%
  ggplot() +
  geom_col(aes(x = Day, y = n, fill = primary_fur_color)) +
  scale_fill_brewer(palette = "Paired") +
  ggtitle('Central Park Squirrels Distribution by Primary Fur Color') +
  theme(plot.title = element_text(hjust = 0.5)) +
  labs( x='Day', y= 'Number of Observations') +
  labs(fill='Primary Fur Color') +
  scale_fill_manual(values = c("#000000", "#D2691E", "#D3D3D3", "white"))
```

### Central Park Squirrels Distribution by Age Group

In this part, we make this pie chart to display the percentage of squirrels by age group.

```{r}
pie_1 = 
  dates %>% 
  filter(age !='?') %>%
  group_by(age) %>%
  count() 

pie_1 %>% 
  mutate(prop = percent(n/sum(pie_1$n))) %>% 
  ggplot(aes(x="", y = n, fill = age)) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start = 0, direction = 1) + 
  theme_void() + 
  ggtitle('Squirrels Distribution by Age Group') +
  geom_text(aes(label = prop),position = position_stack(vjust = 0.5)) +
  scale_fill_brewer()
```
